# Google Apps Script 簡介

## 什麼是 Google Apps Script？

Google Apps Script（簡稱 GAS）是 Google 提供的雲端腳本平台，基於 JavaScript 語言，讓你可以自動化 Google Workspace 服務（如 Sheets、Gmail、Drive、Forms 等）的操作。

### 為什麼要學 GAS？

1. **零安裝**：不需要安裝任何軟體，只要有瀏覽器就能開發
2. **雲端執行**：程式碼在 Google 伺服器上執行，不佔用你的電腦資源
3. **免費使用**：個人使用完全免費，有合理的配額限制
4. **整合方便**：直接存取 Google 服務，不需要複雜的 API 認證
5. **實用性高**：可以解決日常工作中的自動化需求

## GAS 的應用場景

### 1. 資料處理與分析
- 自動整理試算表資料
- 產生統計報表
- 資料驗證與清理

### 2. 自動化通知
- 定時寄送提醒郵件
- 表單提交後自動回覆
- 異常狀況警報

### 3. 檔案管理
- 批次處理檔案
- 自動備份與整理
- 產生 PDF 文件

### 4. 表單與資料收集
- 自動化表單回應處理
- 資料統計與視覺化
- 即時通知相關人員

### 5. Web 應用程式
- 建立簡易的網頁介面
- 資料查詢系統
- 內部管理工具

## GAS 編輯器介面導覽

### 如何開啟 GAS 編輯器？

**方法 1：從 Google Sheets 開啟**
1. 開啟任一 Google 試算表
2. 點選上方選單「擴充功能」→「Apps Script」
3. 會開啟 GAS 編輯器，並自動綁定該試算表

**方法 2：直接建立獨立專案**
1. 前往 https://script.google.com
2. 點選「新專案」
3. 建立獨立的 GAS 專案

### 編輯器介面說明

```
┌─────────────────────────────────────────────────────┐
│  檔案選單  編輯  檢視  執行  發布  資源  說明          │
├─────────────────────────────────────────────────────┤
│  📁 檔案                    ▶ 執行  🐛 偵錯  💾 儲存  │
│  ├─ Code.gs                                         │
│  └─ appsscript.json                                 │
├─────────────────────────────────────────────────────┤
│                                                      │
│  function myFunction() {                            │
│    // 在這裡撰寫程式碼                                │
│  }                                                   │
│                                                      │
│                                                      │
├─────────────────────────────────────────────────────┤
│  執行記錄                                             │
│  顯示執行結果與錯誤訊息                                │
└─────────────────────────────────────────────────────┘
```

### 主要功能區域

1. **檔案管理區**（左側）
   - 管理程式碼檔案（.gs）
   - 管理 HTML 檔案（.html）
   - 設定檔（appsscript.json）

2. **程式碼編輯區**（中央）
   - 撰寫 JavaScript 程式碼
   - 語法高亮顯示
   - 自動完成功能

3. **工具列**（上方）
   - 執行按鈕：執行選定的函式
   - 偵錯按鈕：進行程式除錯
   - 儲存按鈕：儲存程式碼

4. **執行記錄**（下方）
   - 顯示 Logger.log() 的輸出
   - 顯示錯誤訊息
   - 顯示執行時間

## GAS 執行環境

### JavaScript 版本支援

GAS 支援兩種 JavaScript 執行環境：

#### 1. Rhino Runtime（舊版，預設）
- 基於較舊的 JavaScript 標準
- 支援基本的 JavaScript 語法
- 不支援 ES6+ 的新語法（如 let、const、箭頭函式等）

#### 2. V8 Runtime（新版，建議使用）
- 基於 Chrome V8 引擎
- 支援現代 JavaScript 語法（ES6+）
- 效能更好，功能更完整

### 執行限制

GAS 有一些執行限制，需要注意：

| 限制項目 | 免費帳號 |
|---------|---------|
| 單次執行時間 | 6 分鐘 |
| 每日執行時間 | 90 分鐘 |
| 觸發器執行時間 | 6 分鐘 |
| 每日郵件配額 | 100 封 |
| UrlFetch 呼叫次數 | 20,000 次/天 |

### 權限與授權

當你第一次執行 GAS 程式時，系統會要求授權：

1. **為什麼需要授權？**
   - GAS 需要存取你的 Google 服務（Sheets、Gmail 等）
   - 確保安全性，防止未經授權的存取

2. **授權步驟**
   - 點選「執行」按鈕
   - 選擇「檢閱權限」
   - 選擇你的 Google 帳號
   - 點選「允許」

3. **權限範圍**
   - GAS 只會要求程式碼中使用到的權限
   - 可以隨時在 Google 帳號設定中撤銷權限

## 第一個 GAS 程式：Hello World

讓我們來寫第一個 GAS 程式！

### 步驟說明

1. 開啟 GAS 編輯器（從 Google Sheets 或 script.google.com）
2. 在 Code.gs 檔案中輸入以下程式碼
3. 點選上方的「執行」按鈕
4. 查看下方「執行記錄」的輸出

### 程式碼範例

參考：`examples/01-hello-world.gs`

### 執行結果

執行後，在「執行記錄」中會看到：
```
Hello, Google Apps Script!
```

### 程式碼說明

- `function helloWorld()`: 定義一個名為 helloWorld 的函式
- `Logger.log()`: GAS 提供的日誌輸出函式，類似 console.log()
- 執行後結果會顯示在編輯器下方的「執行記錄」區域

## 常見問題

### Q1: 為什麼我的程式碼沒有執行？
**A:** 檢查以下幾點：
- 是否已儲存程式碼？
- 是否已授權權限？
- 函式名稱是否正確？
- 是否有語法錯誤？

### Q2: 如何查看執行結果？
**A:** 
- 使用 `Logger.log()` 輸出資訊
- 查看編輯器下方的「執行記錄」
- 點選「檢視」→「記錄」查看完整記錄

### Q3: 程式碼儲存在哪裡？
**A:** 
- 從 Sheets 開啟：綁定在該試算表中
- 獨立專案：儲存在你的 Google Drive 中

### Q4: 可以離線使用嗎？
**A:** 
- 不行，GAS 需要網路連線
- 程式碼在雲端編輯與執行

## 下一步

現在你已經了解 GAS 的基本概念，接下來我們將學習：
- JavaScript 基礎語法
- 變數與資料型別
- 流程控制
- 函式與陣列
- 實際應用案例

準備好了嗎？讓我們開始學習 JavaScript 吧！
