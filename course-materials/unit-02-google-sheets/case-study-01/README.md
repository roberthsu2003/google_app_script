# 實作案例 1：學生成績登錄系統

## 專案概述

本專案將建立一個完整的學生成績管理系統，讓教師能夠透過對話框介面輸入學生成績，系統會自動計算平均分數、判定等級，並套用視覺化格式。此外，系統還能產生班級統計報表，幫助教師快速了解整體學習狀況。

## 學習目標

完成本專案後，你將能夠：

1. 熟練使用 SpreadsheetApp 進行資料讀寫操作
2. 建立使用者友善的 UI 對話框介面
3. 實作資料驗證與錯誤處理機制
4. 應用條件格式化美化試算表
5. 撰寫資料統計與分析函式
6. 整合 JavaScript 基礎語法（陣列、物件、函式、流程控制）

## 專案需求

### 功能需求

#### 1. 成績輸入介面
- 提供對話框讓使用者輸入學生資料
- 輸入欄位：學號、姓名、國文成績、英文成績、數學成績
- 資料驗證：
  - 學號不可為空
  - 姓名不可為空
  - 成績必須為 0-100 之間的數字
  - 成績可以是小數（如 85.5）

#### 2. 自動計算功能
- 自動計算三科平均分數（四捨五入到小數點後 2 位）
- 根據平均分數自動判定等級：
  - 90 分以上：優
  - 80-89 分：良
  - 60-79 分：可
  - 60 分以下：待加強

#### 3. 自動格式化
- 及格科目（≥60 分）：綠色背景
- 不及格科目（<60 分）：紅色背景
- 標題列：粗體、灰色背景
- 數字欄位：置中對齊

#### 4. 班級統計報表
- 計算各科平均分數
- 計算各科最高分、最低分
- 統計各等級人數分布
- 計算及格率

### 非功能需求

1. **效能**：使用批次操作提升效能
2. **使用者體驗**：提供清楚的錯誤訊息
3. **程式碼品質**：函式模組化、註解完整
4. **資料安全**：驗證所有輸入資料

## 試算表資料結構

### 工作表 1：學生成績

| 欄位 | 說明 | 資料型別 | 範例 |
|------|------|----------|------|
| 學號 | 學生學號 | 文字 | S20240001 |
| 姓名 | 學生姓名 | 文字 | 王小明 |
| 國文 | 國文成績 | 數字 | 85 |
| 英文 | 英文成績 | 數字 | 90 |
| 數學 | 數學成績 | 數字 | 88 |
| 平均 | 三科平均 | 數字 | 87.67 |
| 等級 | 成績等級 | 文字 | 優 |

### 工作表 2：班級統計（選用）

可以在另一個工作表中顯示統計資料，或直接在主工作表下方顯示。

## 系統架構

```
使用者介面 (UI Dialog)
    ↓
資料驗證 (validateInput)
    ↓
計算平均分數 (calculateAverage)
    ↓
判定等級 (determineGrade)
    ↓
寫入試算表 (writeToSheet)
    ↓
套用格式 (applyFormatting)
    ↓
產生統計報表 (generateStatistics)
```

## 核心函式說明

### 1. showInputDialog()
顯示成績輸入對話框，收集使用者輸入。

### 2. validateInput(data)
驗證輸入資料的正確性，回傳驗證結果。

### 3. calculateAverage(chinese, english, math)
計算三科平均分數，四捨五入到小數點後 2 位。

### 4. determineGrade(average)
根據平均分數判定等級（優/良/可/待加強）。

### 5. addStudent(studentData)
將學生資料寫入試算表，並套用格式。

### 6. applyFormatting(row)
對指定列套用條件格式化（及格/不及格）。

### 7. generateStatistics()
產生班級統計報表，包含各科平均、最高分、最低分、等級分布。

### 8. initializeSheet()
初始化試算表，建立標題列並套用格式。

## 技能整合

本專案整合了以下技能：

### JavaScript 基礎
- 變數宣告與資料型別
- 函式定義與呼叫
- 條件判斷（if-else）
- 陣列操作（map, filter, reduce）
- 物件操作
- 錯誤處理（try-catch）

### SpreadsheetApp 操作
- 取得試算表與工作表
- 範圍選取（getRange, getLastRow）
- 資料讀寫（getValue, getValues, setValue, setValues）
- 格式設定（setBackground, setFontWeight, setHorizontalAlignment）
- 數字格式（setNumberFormat）

### UI 服務
- 建立對話框（UI.prompt）
- 顯示訊息（UI.alert）
- 處理使用者輸入

## 預期成果

完成本專案後，你將擁有一個功能完整的成績管理系統：

1. ✅ 可透過對話框快速輸入學生成績
2. ✅ 自動計算平均分數與等級
3. ✅ 視覺化呈現及格/不及格狀態
4. ✅ 一鍵產生班級統計報表
5. ✅ 程式碼結構清晰、易於維護

## 延伸挑戰

完成基本功能後，可以嘗試以下進階功能：

1. **批次匯入**：從 CSV 檔案批次匯入學生成績
2. **成績修改**：提供介面修改已存在的學生成績
3. **成績查詢**：根據學號或姓名查詢成績
4. **圖表視覺化**：使用 Google Sheets 圖表 API 產生成績分布圖
5. **匯出功能**：將統計報表匯出為 PDF
6. **多班級管理**：支援多個班級的成績管理
7. **歷史記錄**：記錄成績修改歷史
8. **權限控制**：限制只有教師可以修改成績

## 相關需求

本專案對應以下課程需求：

- **需求 2.1-2.4**：透過實際案例學習，提供詳細步驟說明
- **需求 3.1**：SpreadsheetApp 基本操作
- **需求 3.2**：資料讀寫與批次操作
- **需求 3.3**：格式化與進階操作
- **需求 3.4**：完整的實作案例

## 下一步

請參考以下文件開始實作：

1. 📄 `implementation-guide.md` - 逐步實作指引
2. 💻 `Code.gs` - 完整程式碼
3. 🧪 `test-data.md` - 測試資料與測試方法

祝你實作順利！🚀
