# 實作案例 3：Google Form 自動收集與統計

## 專案概述

本專案將建立一個自動化的問卷收集與統計系統，透過 Google Form 收集資料，並自動進行統計分析與圖表產生。系統會在每次表單提交時自動觸發，即時更新統計結果。

## 學習目標

完成本專案後，你將能夠：

1. 程式化建立與管理 Google Form 表單
2. 使用表單提交觸發器（onFormSubmit）處理即時回應
3. 自動收集並整理表單資料到試算表
4. 進行資料統計分析（計數、百分比、平均值）
5. 程式化產生圖表視覺化統計結果
6. 整合 FormApp、SpreadsheetApp 與觸發器

## 專案需求

### 功能需求

#### 1. 表單建立
- 建立包含多種題型的問卷表單
- 題型包含：文字題、單選題、多選題、評分題
- 設定必填欄位與說明文字
- 自動連結到指定的試算表

#### 2. 自動資料收集
- 表單提交時自動觸發程式
- 收集回應資料並記錄到「原始回應」工作表
- 記錄提交時間戳記
- 自動編號每筆回應

#### 3. 統計分析
- 自動計算各選項的選擇次數
- 計算百分比分布
- 計算評分題的平均分數
- 統計總回應數
- 將統計結果寫入「統計分析」工作表

#### 4. 圖表產生
- 為單選題產生圓餅圖
- 為多選題產生長條圖
- 為評分題產生折線圖
- 圖表自動更新
- 圖表放置在「統計分析」工作表

#### 5. 觸發器管理
- 設定表單提交觸發器
- 提供手動執行統計的功能
- 錯誤處理與日誌記錄

### 非功能需求

1. **效能**：處理 100+ 筆回應時仍能快速執行
2. **可靠性**：包含完整的錯誤處理機制
3. **可維護性**：程式碼結構清晰，註解完整
4. **使用者友善**：提供清楚的統計報表格式

## 技術架構

### 資料流程

```
使用者填寫表單
    ↓
表單提交
    ↓
觸發 onFormSubmit 事件
    ↓
收集回應資料
    ↓
寫入「原始回應」工作表
    ↓
執行統計分析
    ↓
更新「統計分析」工作表
    ↓
產生/更新圖表
```

### 試算表結構

#### 工作表 1：原始回應（自動產生）
- 由 Google Form 自動建立
- 包含所有表單欄位
- 時間戳記自動記錄

#### 工作表 2：統計分析（程式產生）
- 題目名稱
- 選項內容
- 選擇次數
- 百分比
- 圖表區域

### 使用的 GAS 服務

- **FormApp**：建立與管理表單
- **SpreadsheetApp**：資料讀寫與格式化
- **Charts**：產生圖表
- **Triggers**：設定表單提交觸發器

## 範例問卷主題

本專案以「課程滿意度調查」為範例，包含以下題目：

1. **姓名**（文字題，必填）
2. **課程整體滿意度**（單選題，必填）
   - 非常滿意
   - 滿意
   - 普通
   - 不滿意
   - 非常不滿意

3. **最喜歡的課程單元**（多選題）
   - JavaScript 基礎
   - Google Sheets 操作
   - 自動寄信功能
   - 檔案與雲端操作
   - Web App 開發
   - API 整合

4. **課程難度評分**（評分題，1-5 分）

5. **建議與回饋**（長文字題）

## 預期成果

完成本專案後，你將擁有：

1. ✅ 一個完整的 Google Form 問卷
2. ✅ 自動收集回應的試算表
3. ✅ 即時更新的統計分析報表
4. ✅ 視覺化的統計圖表
5. ✅ 可重複使用的表單統計系統

## 技能整合

本專案整合了以下技能：

- ✓ JavaScript 陣列操作（map、filter、reduce）
- ✓ JavaScript 物件處理
- ✓ FormApp 表單建立與管理
- ✓ SpreadsheetApp 資料讀寫
- ✓ 表單提交觸發器
- ✓ 資料統計與分析
- ✓ 圖表產生與更新
- ✓ 錯誤處理與日誌記錄

## 延伸挑戰

完成基本功能後，可以嘗試：

1. 📊 新增更多圖表類型（堆疊長條圖、雷達圖）
2. 📧 統計結果自動寄送給管理員
3. 🔔 達到特定回應數時發送通知
4. 📈 建立趨勢分析（比較不同時間段的結果）
5. 🎨 美化統計報表格式
6. 🔍 新增資料篩選功能
7. 📱 建立 Web App 顯示即時統計

## 注意事項

1. **權限設定**：確保腳本有權限存取表單與試算表
2. **觸發器限制**：注意 GAS 觸發器的執行時間限制（6 分鐘）
3. **配額管理**：大量回應時注意 API 呼叫配額
4. **資料驗證**：處理空白或異常的回應資料
5. **圖表更新**：舊圖表需要先刪除再建立新的

## 相關資源

- [FormApp 官方文件](https://developers.google.com/apps-script/reference/forms)
- [SpreadsheetApp 官方文件](https://developers.google.com/apps-script/reference/spreadsheet)
- [觸發器官方文件](https://developers.google.com/apps-script/guides/triggers)
- [圖表服務文件](https://developers.google.com/apps-script/reference/charts)

---

**準備好了嗎？讓我們開始建立這個自動化統計系統！** 🚀
