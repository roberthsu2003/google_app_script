# 實作案例 4：雲端硬碟整理助手 - 實作指引

## 快速開始

### 1. 準備測試資料夾

1. 在你的 Google Drive 中建立一個測試資料夾
2. 在資料夾中放入一些測試檔案（不同類型）
3. 複製資料夾的 ID（從 URL 中取得）

### 2. 設定程式碼

1. 開啟 Apps Script 編輯器
2. 複製 `Code.gs` 的內容
3. 設定 `SOURCE_FOLDER_ID` 為你的測試資料夾 ID：

```javascript
var SOURCE_FOLDER_ID = '你的資料夾ID';
```

### 3. 執行掃描

先執行 `scanOnly()` 函式查看資料夾內容：

```
=== 掃描資料夾 ===
資料夾：測試資料夾

1. 文件.docx
   類型：Word 文件
   大小：25.50 KB
   修改：2024-01-15 10:30:00

2. 照片.jpg
   類型：圖片
   大小：1.20 MB
   修改：2024-01-14 15:20:00

✅ 掃描完成，共 10 個檔案

=== 分類統計 ===
Word 文件：2 個
圖片：3 個
PDF：2 個
其他：3 個
```

### 4. 執行整理

執行 `organizeFiles()` 函式開始整理：

```
========================================
開始整理雲端硬碟
========================================

=== 掃描資料夾 ===
...

=== 建立分類資料夾 ===
主資料夾：已整理

1. ✅ Google 文件
2. ✅ Google 試算表
3. ✅ PDF
4. ✅ Word 文件
5. ✅ 圖片
...

=== 移動檔案 ===

1. ✅ 文件.docx → Word 文件
2. ✅ 照片.jpg → 圖片
3. ✅ 報告.pdf → PDF
...

✅ 已移動 10 個檔案

========================================
=== 雲端硬碟整理報告 ===
========================================

整理時間：2024-01-15 16:45:30
整理資料夾：測試資料夾

【掃描結果】
總檔案數：10

【分類統計】
Word 文件：2 個
圖片：3 個
PDF：2 個
其他：3 個

【移動檔案】
已移動：10 個檔案

【刪除檔案】
已刪除：0 個檔案（超過 30 天）

========================================
整理完成！
========================================

執行時間：3.45 秒
```

### 5. 檢查結果

開啟你的測試資料夾，應該看到：

```
測試資料夾
└── 已整理
    ├── Word 文件
    │   ├── 文件1.docx
    │   └── 文件2.docx
    ├── 圖片
    │   ├── 照片1.jpg
    │   ├── 照片2.jpg
    │   └── 照片3.png
    ├── PDF
    │   ├── 報告1.pdf
    │   └── 報告2.pdf
    └── 其他
        ├── 檔案1.txt
        ├── 檔案2.csv
        └── 檔案3.zip
```

## 進階功能

### 啟用舊檔案刪除

在 `organizeFiles()` 函式中，找到這段程式碼：

```javascript
// 步驟 5：刪除舊檔案（可選）
// 取消下方註解以啟用舊檔案刪除功能
// var deletedCount = deleteOldFiles(fileList, DAYS_TO_KEEP);
var deletedCount = 0;  // 預設不刪除
```

取消註解以啟用：

```javascript
// 步驟 5：刪除舊檔案
var deletedCount = deleteOldFiles(fileList, DAYS_TO_KEEP);
// var deletedCount = 0;  // 預設不刪除
```

### 調整保留天數

修改 `DAYS_TO_KEEP` 變數：

```javascript
var DAYS_TO_KEEP = 30;  // 改為你想要的天數
```

### 自訂分類規則

在 `getFileCategories()` 函式中新增或修改分類：

```javascript
function getFileCategories() {
  return {
    'Google 文件': [MimeType.GOOGLE_DOCS],
    'PDF': [MimeType.PDF],
    // 新增自訂分類
    '程式碼': [
      'text/x-python',
      'text/javascript',
      'text/html'
    ],
    // ... 其他分類
  };
}
```

## 常見問題

### Q1：權限錯誤

**解決方案：** 確保你有權限存取目標資料夾

### Q2：檔案沒有移動

**可能原因：** 檔案已經在「已整理」資料夾中

**解決方案：** 檢查程式碼邏輯，確保不會重複移動

### Q3：執行時間過長

**解決方案：** 
- 減少檔案數量
- 分批處理
- 優化程式碼

### Q4：某些檔案分類錯誤

**解決方案：** 檢查 `getFileCategories()` 中的 MIME 類型設定

## 延伸練習

1. 新增更多檔案類型分類
2. 實作檔案重複偵測
3. 新增整理報告寄送功能
4. 設定定期自動整理觸發器
5. 實作檔案大小限制功能

## 總結

你已經完成了雲端硬碟整理助手！這個工具可以：

- ✅ 自動掃描資料夾
- ✅ 依類型分類檔案
- ✅ 自動移動檔案
- ✅ 刪除舊檔案
- ✅ 產生整理報告

繼續探索更多功能，讓你的整理工具更加完善！
